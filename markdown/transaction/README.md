# Redis

## 事务

redis保证一个事务内的若干个命令要么远不执行，要么都不执行

### 基本用法

要执行一个事务，首先输入MULTI命令表示事务的开始，然后依次输入要执行的操作，最后输入EXEC命令结束一个事务

```
> MULTI
OK
> INCR foo
QUEUED
> INCR bar
QUEUED
> EXEC
1) (integer) 1
2) (integer) 1
```

在输入MULTI命令的时候，系统总是返回OK，这不代表事务已经准备执行了，在下面输入命令的过程中，redis只是把它们保存在一个队列里面，等到EXEC后来依次顺序执行所有的命令

对于在事务执行过程中出现了错误，分两种情况处理
* 当EXEC执行之前发生了错误，提交给服务器服务器也会终止不执行任何命令
* 当EXEC执行的过程中出现了错误，会继续执行下面的命令而不是回滚

Redis不支持回滚，原因有两个，1) 实现起来复杂，影响性能，2)程序出现错误肯定是编程人员的错误，redis回滚了也帮不上什么忙，这种错误只能程序员自己改。第二个原因有点牵强
